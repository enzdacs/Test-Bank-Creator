<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BoardNotch</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="theme-toggle" onclick="app.toggleDarkMode()" title="Toggle Dark Mode">
        <span id="themeIcon">‚òÄÔ∏è</span>
    </button>

    <button class="gemini-btn" onclick="app.showGeminiModal()" title="AI Generate Questions">
        ‚ú®<span id="themeIcon">AI</span>
    </button>

    <div class="container">
        <div class="header">
            <h1>üìö BoardNotch (RRT 2025)</h1>
            <p>Philippians 4:6 - "Don‚Äôt worry about anything; instead, pray about everything..."</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="app.switchTab('manage')">Manage Banks</button>
            <button class="nav-tab" onclick="app.switchTab('study')">Study Mode</button>
            <button class="nav-tab" onclick="app.switchTab('take')">Boards Mode</button>
            <button class="nav-tab" onclick="app.switchTab('game')">Quiz Game</button>
            <button class="nav-tab" onclick="app.switchTab('analytics')">Analytics</button>
        </div>

        <div class="content">
            <div id="manage" class="tab-content active">
                <h2>Create New Test Bank <span style="font-size: 0.7em; color: #6c757d; font-weight: normal;">(Enter Bank Title)</span></h2>
                <div class="input-group">
                    <input type="text" id="bankTitle" placeholder="e.g., Cluster 1, Exam, Posi" oninput="app.toggleQuestionsInput()">
                </div>
                <div class="input-group" id="questionsInputGroup" style="display: none;"> 
                    <label>Paste Questions <span style="font-weight: normal; color: #6c757d;">(Follow the sample format below)</span></label>
                    <textarea id="questionsInput" placeholder="Q1: Question Text.&#10;A. Option 1&#10;B. Option 2&#10;C. Option 3&#10;*D. Correct answer&#10;&#10;Q2: Next Question Text.&#10;A. Option 1&#10;*B. Correct answer&#10;C. Option 3&#10;D. Option 4"></textarea>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: stretch;">
                    <button class="btn btn-primary" onclick="app.bulkAddQuestions()">‚ûï Add Questions/Save Test Bank</button>
                    <button class="btn btn-secondary" onclick="app.exportAllData()" style="flex: 1; min-width: 140px;">üì§ Export All</button>
                    <button class="btn btn-secondary" onclick="app.showImportModal()" style="flex: 1; min-width: 140px;">üì• Import</button>
                    <button class="btn btn-primary" onclick="app.openRRTResults()" style="flex: 1; min-width: 140px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">üèÜ RRT Results</button>
                    <button class="btn btn-primary" onclick="app.showSurprise()" style="flex: 1; min-width: 140px; background: linear-gradient(135deg, #29b157 0%, #27b49a 100%);">Secret</button>
                </div>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="app.importData(event)">

                <h2 style="margin-top: 40px;">Your Test Banks</h2>
                <div id="testBankList" class="test-bank-list"></div>
            </div>

            <div id="take" class="tab-content">
                <h2>Select a Test Bank</h2>
                <div class="input-group">
                    <select id="selectBank" onchange="app.loadQuizSettings()">
                        <option value="">Choose a test bank...</option>
                    </select>
                </div>

                <div id="quizSettings" style="display: none;">
                    <h3>Quiz Settings</h3>
                    <div class="input-group">
                        <label>Number of Questions</label>
                        <select id="questionCount" onchange="app.toggleCustomQuestionCount()">
                            <option value="all">All Questions</option>
                            <option value="10">10 Questions</option>
                            <option value="30">30 Questions</option>
                            <option value="50">50 Questions</option>
                            <option value="100">100 Questions</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    <div class="input-group" id="customQuestionInput" style="display: none;">
                        <label>Enter number of questions</label>
                        <input type="number" id="customQuestionNumber" min="1" placeholder="Enter number">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="shuffleQuestions">
                        <label for="shuffleQuestions">Shuffle questions</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="immediateMode" checked>
                        <label for="immediateMode">Show answer immediately after each question</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="timerEnabled">
                        <label for="timerEnabled">Enable timer</label>
                    </div>
                    <div class="input-group" id="timerInput" style="display: none;">
                        <label>Time Limit (minutes)</label>
                        <input type="number" id="timeLimit" value="30" min="1">
                    </div>
                    <button class="btn btn-primary" onclick="app.startQuiz()">Start Quiz</button>
                </div>

                <div id="quizContainer" style="display: none;"></div>
            </div>

            <div id="study" class="tab-content">
                <h2>Study Mode - Flashcard Learning</h2>
                <div class="input-group">
                    <label>Select a Test Bank to Study</label>
                    <select id="studySelectBank" onchange="app.loadStudyMode()">
                        <option value="">Choose a test bank...</option>
                    </select>
                </div>

                <div id="studyContainer" style="display: none;">
                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn btn-secondary" onclick="app.shuffleStudyCards()">üîÄ Shuffle Cards</button>
                        <button class="btn btn-danger" onclick="app.exitStudyMode()">‚ùå Exit Study Mode</button>
                    </div>

                    <div id="flashcardContainer" style="perspective: 1000px; min-height: 400px;">
                        </div>

                    <div style="text-align: center; margin-top: 20px;">
                        <span id="cardCounter" style="font-size: 1.2em; font-weight: bold; color: #667eea;"></span>
                    </div>

                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="app.previousCard()" id="prevBtn">‚¨ÖÔ∏è Previous</button>
                        <button class="btn btn-primary" onclick="app.flipCard()">üîÑ Flip Card</button>
                        <button class="btn btn-secondary" onclick="app.nextCard()" id="nextBtn">Next ‚û°Ô∏è</button>
                    </div>
                </div>
            </div>

            <div id="game" class="tab-content">
                <h2>üéÆ Quiz Game Mode</h2>
                <p style="color: #6c757d; margin-bottom: 20px;">Quick-fire questions with points and streaks!</p>

                <div class="input-group">
                    <label>Select a Test Bank</label>
                    <select id="gameSelectBank" onchange="app.loadGameSettings()">
                        <option value="">Choose a test bank...</option>
                    </select>
                </div>

                <div id="gameSettings" style="display: none;">
                    <h3>Game Settings</h3>
                    <div class="input-group">
                        <label>Number of Questions</label>
                        <select id="gameQuestionCount">
                            <option value="10">10 Questions</option>
                            <option value="20">20 Questions</option>
                            <option value="30">30 Questions</option>
                            <option value="50">50 Questions</option>
                            <option value="all">All Questions</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="gameTimerEnabled" checked onchange="app.toggleTimeSelector()">
                        <label for="gameTimerEnabled">Enable time limit per question</label>
                    </div>
                    <div class="input-group" id="timePerQuestionSelector">
                        <label>Seconds per question (1-59)</label>
                        <input type="number" id="gameTimePerQuestion" value="15" min="1" max="59" style="width: 100px;">
                    </div>
                    <button class="btn btn-primary" onclick="app.startGame()">üéÆ Start Game</button>
                </div>

                <div id="gameContainer" style="display: none;"></div>

                <div id="gameAnalytics" style="margin-top: 40px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0;">üèÜ Game Statistics</h3>
                        <button class="btn btn-danger" onclick="app.clearGameStats()" style="padding: 8px 16px; min-width: auto;">üóëÔ∏è Clear Stats</button>
                    </div>
                    <div id="gameStatsContent"></div>
                </div>
            </div>

            <div id="analytics" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                    <h2 style="margin: 0;">Your Performance Analytics</h2>
                    <button class="btn btn-danger" onclick="app.clearBoardStats()" style="padding: 10px 20px; min-width: auto;">üóëÔ∏è Clear Board Exam Stats</button>
                </div>
                <div style="margin: 20px 0;">
                    <button class="btn btn-primary" onclick="app.showAnalyticsChart('bar')">üìä Bar Chart</button>
                    <button class="btn btn-primary" onclick="app.showAnalyticsChart('pie')">ü•ß Pie Chart</button>
                    <button class="btn btn-primary" onclick="app.showAnalyticsChart('table')">üìã Table View</button>
                </div>
                <div id="analyticsContent"></div>
            </div>
        </div>
    </div>

    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin: 0;">Import Test Banks</h2>
                <button class="modal-close-btn" onclick="app.closeImportModal()">√ó</button>
            </div>
            <p style="margin: 15px 0;">Choose import method:</p>

            <button class="btn btn-primary" onclick="document.getElementById('importFile').click()" style="width: 100%; margin: 10px 0;">
                üìÅ Upload JSON File
            </button>

            <div style="text-align: center; margin: 20px 0; color: #6c757d;">OR</div>

            <div class="share-code-box">
                <label style="font-weight: bold; margin-bottom: 10px; display: block;">Paste Share Link:</label>
                <input type="text" id="importCodeInput" placeholder="Paste the share link here...">
                <button class="btn btn-success" onclick="app.importFromCode()" style="width: 100%; margin-top: 10px;">
                    Import from Link
                </button>
            </div>
        </div>
    </div>

    <div id="shareModal" class="modal">
        <div class="modal-content compact">
            <div class="modal-header">
                <h2 id="shareModalTitle" style="margin: 0; font-size: 1.5em;">Share Test Bank</h2>
                <button class="modal-close-btn" onclick="app.closeShareModal()">√ó</button>
            </div>
            <p style="margin: 15px 0; font-size: 0.95em;">Copy this link and send it to anyone!</p>

            <div class="share-code-box">
                <div class="share-link-box">
                    <input type="text" id="shareCodeOutput" readonly>
                    <button class="copy-btn" onclick="app.copyShareCode()">üìã</button>
                </div>
            </div>

            <div style="text-align: center; margin: 15px 0; color: #6c757d; font-size: 0.9em;">OR</div>

            <button class="btn btn-secondary" onclick="app.exportSingleBank()" style="width: 100%;">
                üì• Export as JSON File
            </button>
        </div>
    </div>

    <div id="viewModal" class="modal">
        <div class="modal-content" style="max-width: 900px; display: flex; flex-direction: column; max-height: 90vh; padding: 0;">
            <div class="modal-header" style="flex-shrink: 0; padding: 20px 30px; margin: 0; position: relative; top: 0; display: block;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 id="viewBankTitle" style="margin: 0;">View Test Bank</h2>
                    <button class="modal-close-btn" onclick="app.closeViewModal()">√ó</button>
                </div>
                <div class="input-group" style="margin-bottom: 0;">
                    <input type="text" id="viewSearchInput" placeholder="üîç Search questions or answers..." oninput="app.filterViewQuestions()" style="margin: 0;">
                </div>
            </div>

            <div style="flex: 1; overflow-y: auto; padding: 20px 30px;">
                <div id="viewQuestionsList"></div>
                <div id="viewNoResults" style="display: none; text-align: center; padding: 40px; color: #6c757d;">
                    No questions found matching your search.
                </div>
            </div>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content" style="max-width: 900px; display: flex; flex-direction: column; max-height: 90vh; padding: 0;">
            <div class="modal-header" style="flex-shrink: 0; padding: 20px 30px; margin: 0; position: relative; top: 0; display: block;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 id="editBankTitle" style="margin: 0;">Edit Test Bank</h2>
                    <button class="modal-close-btn" onclick="app.closeEditModal()">√ó</button>
                </div>
                <div class="input-group" style="margin-bottom: 0;">
                    <input type="text" id="editSearchInput" placeholder="üîç Search questions or answers..." oninput="app.filterEditQuestions()" style="margin: 0;">
                </div>
            </div>

            <div style="flex: 1; overflow-y: auto; padding: 0 30px;">
                <div class="input-group" style="margin-top: 20px;">
                    <label>Test Bank Name</label>
                    <input type="text" id="editBankName" placeholder="Enter new name">
                </div>

                <h3 style="margin-top: 30px;">Add New Questions</h3>
                <div class="input-group">
                    <label>Paste Questions (Same format as Manage Banks)</label>
                    <textarea id="editQuestionsInput" placeholder="Q#: Question text&#10;A. Option 1&#10;B. Option 2&#10;C. Option 3&#10;*D. Correct answer"></textarea>
                </div>
                <button class="btn btn-primary" onclick="app.addQuestionsToBank()" style="width: 100%; margin-bottom: 20px;">
                    ‚ûï Add These Questions
                </button>

                <h3 style="margin-top: 30px;">Existing Questions</h3>
                <div id="editQuestionsList"></div>
                <div id="editNoResults" style="display: none; text-align: center; padding: 40px; color: #6c757d;">
                    No questions found matching your search.
                </div>
            </div>

            <div class="modal-footer" style="flex-shrink: 0; padding: 15px 30px; margin: 0; position: relative; bottom: 0;">
                <button class="btn btn-success" onclick="app.saveEditedBank()" style="min-width: 150px;">üíæ Save Changes</button>
                <button class="btn btn-secondary" onclick="app.closeEditModal()" style="min-width: 150px;">Cancel</button>
            </div>
        </div>
    </div>

    <div id="geminiModal" class="modal">
        <div class="modal-content compact">
            <div class="modal-header">
                <h2 style="margin: 0;">‚ú® AI Generate Questions</h2>
                <button class="modal-close-btn" onclick="app.closeGeminiModal()">√ó</button>
            </div>

            <div class="input-group">
                <label>Topic or Subject</label>
                <input type="text" id="geminiTopic" placeholder="e.g., Philippine Constitution, Biology, Mathematics">
            </div>

            <div class="input-group">
                <label>Number of Questions</label>
                <select id="geminiCount">
                    <option value="5">5 questions</option>
                    <option value="10" selected>10 questions</option>
                    <option value="15">15 questions</option>
                    <option value="20">20 questions</option>
                </select>
            </div>

            <div class="input-group">
                <label>Difficulty Level</label>
                <select id="geminiDifficulty">
                    <option value="easy">Easy</option>
                    <option value="medium" selected>Medium</option>
                    <option value="hard">Hard</option>
                </select>
            </div>

            <button class="btn btn-primary" onclick="app.generateWithGemini()" style="width: 100%;">
                ü§ñ Generate Questions
            </button>

            <div id="geminiResult" style="margin-top: 20px; display: none;">
                <h4>Generated Questions:</h4>
                <textarea id="geminiOutput" readonly style="width: 100%; min-height: 300px; font-family: monospace; font-size: 0.9em;"></textarea>
                <button class="btn btn-success" onclick="app.useGeminiQuestions()" style="width: 100%; margin-top: 10px;">
                    ‚úÖ Use These Questions
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
